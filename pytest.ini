[pytest]
markers =
    enable_socket: allow tests to make network calls
    finastra_live: marks tests that hit Finastra sandbox (deselect with -m "not finastra_live")

filterwarnings =
    ignore:Unknown config option
    # FastAPI lifecycle deprecation
    ignore:@app\.on_event.*deprecated:DeprecationWarning
    ignore:.*on_event is deprecated.*:DeprecationWarning
    ignore::DeprecationWarning:fastapi\.applications
    ignore:.*on_event is deprecated.*:DeprecationWarning:credit_facility\.api
    ignore::DeprecationWarning:bank_connector\.main
    ignore::DeprecationWarning:credit_facility\.api
    # Pydantic v2 deprecation notices
    ignore:.*Pydantic V1 style `@validator` validators are deprecated:DeprecationWarning
    ignore:The `parse_obj` method is deprecated;.*:DeprecationWarning
    ignore:`json_encoders` is deprecated.*:DeprecationWarning
    # SQLModel duplicate class registration in tests (no category â†’ avoids importing sqlalchemy)
    ignore:This declarative base already contains a class with the same class name
    # httpx content upload deprecation
    ignore:Use 'content=<.*>' to upload raw bytes/text content:DeprecationWarning

asyncio_mode = auto

env =
    BANK_API_URL = https://127.0.0.1:8000
    USE_MOCK_BALANCES = 1
